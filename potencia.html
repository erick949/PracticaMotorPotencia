<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Indicador de Potencia</title>
<style>
  body {
    background-color: #0b1221;
    color: white;
    font-family: 'Arial', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    margin: 0;
    overflow: hidden;
  }

  h1 {
    margin-bottom: 20px;
    font-size: 2.5em;
    transition: color 0.3s;
  }

  .contenedor {
    position: relative;
    width: 220px;
    height: 220px;
    transition: all 0.3s ease;
  }

  .pentagono {
    position: absolute;
    width: 100%;
    height: 100%;
    clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);
    background-color: #ffffff10;
    transition: background-color 0.4s ease, box-shadow 0.4s ease;
  }

  .nivel-activo {
    box-shadow: 0 0 20px #00ff55a0;
  }

  /* --- Estado deshabilitado --- */
  .deshabilitado {
    opacity: 0.4;
    filter: blur(3px) brightness(0.8);
    pointer-events: none;
  }

  .aviso {
    margin-top: 20px;
    color: #ff5555;
    font-weight: bold;
    font-size: 1.1em;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .aviso.visible {
    opacity: 1;
  }
</style>
</head>
<body>

<h1 id="texto-potencia">Potencia: 0/10</h1>
<div class="contenedor" id="contenedor"></div>
<div class="aviso" id="aviso">⚠ Indicador deshabilitado</div>

<script>
  // --- BLOQUEO DE ZOOM ---
  document.addEventListener('wheel', e => { if (e.ctrlKey) e.preventDefault(); }, { passive: false });
  document.addEventListener('keydown', e => { if ((e.ctrlKey || e.metaKey) && ['+','-','='].includes(e.key)) e.preventDefault(); });
  document.addEventListener('gesturestart', e => e.preventDefault());
  // ------------------------

  const totalPotencia = 10;
  const contenedor = document.getElementById('contenedor');
  const texto = document.getElementById('texto-potencia');
  const aviso = document.getElementById('aviso');

  let habilitado = false; // 🔒 Inicia deshabilitado

  // Crear capas del pentágono una sola vez
  for (let i = 0; i < totalPotencia; i++) {
    const capa = document.createElement('div');
    capa.classList.add('pentagono');
    const scale = 1 - (i * 0.08);
    capa.style.transform = `scale(${scale})`;
    contenedor.appendChild(capa);
  }

  const capas = [...contenedor.children].reverse();

  function calcularColor(nivel) {
    const r = Math.min(255, Math.round((nivel / totalPotencia) * 255 * 1.5));
    const g = Math.max(0, Math.round(255 - (nivel / totalPotencia) * 255));
    return `rgb(${r}, ${g}, 50)`;
  }

  // ✅ Función para habilitar/deshabilitar visualmente el indicador
  function habilitar(estado) {
    habilitado = estado;
    if (habilitado) {
      contenedor.classList.remove('deshabilitado');
      aviso.classList.remove('visible');
    } else {
      contenedor.classList.add('deshabilitado');
      aviso.classList.add('visible');
    }
  }

  // ⚙️ Actualiza el nivel de potencia (solo si está habilitado)
  function setPotencia(valor) {
    if (!habilitado) {
      console.warn("⚠ setPotencia() ignorado: indicador deshabilitado");
      return;
    }

    const potencia = Math.min(Math.max(valor, 0), totalPotencia);
    texto.textContent = `Potencia: ${potencia}/10`;

    const colorActual = calcularColor(potencia);
    texto.style.color = colorActual;

    capas.forEach((capa, i) => {
      if (i < potencia) {
        const colorCapa = calcularColor(i + 1);
        capa.classList.add('nivel-activo');
        capa.style.background = `radial-gradient(circle at center, ${colorCapa} 30%, transparent 100%)`;
        capa.style.boxShadow = `0 0 20px ${colorCapa}80`;
      } else {
        capa.classList.remove('nivel-activo');
        capa.style.background = '#ffffff10';
        capa.style.boxShadow = 'none';
      }
    });
  }

  // --- Inicialización ---
  habilitar(true); // Inicia deshabilitado
  setPotencia(0);   // Valor inicial visual
  habilitar(false); // Inicia deshabilitado

  // 💡 Ejemplo de activación (puedes quitar esto en producción)
  // setTimeout(() => {
  //   habilitar(true);
  //   setPotencia(6);
  // }, 3000);
</script>

</body>
</html>
